Tällä viikolla sain avaimet käteen toisella puolella kaupunkia sijaitsevaan uuteen kotiin. Aika kurssin työstämiseen oli siis hieman kortilla. Edellisen viikon palautteen perusteella omien tietorakenteiden tekeminen ei ole tarpeellista joten pääsin suoraan kehittämään itse laskimeen liittyviä ominaisuuksia.

Alkuviikon pohdiskelujen jälkeen tulin tulokseen, että syöte on aluksi järkevintä pilkkoa mielekkäisiin palasiin (arvot, laskutoimitukset, funktiot, muuttujat) ja tämän jälkeen validoida syötteen oikeellisuus. Käytännössä siis toimitaan kuten ohjelmointikieliä kääntäessä eli ensin tehdään leksikaalinen analyysi ja sitten syntaktinen. Tällä viikolla sain ohjelman pilkkomaan syötteen ihan järkevällä tavalla palasiksi. Toistaiseksi tuetut funktiot ovat sini, kosini ja tangentti, mutta tarkoituksena oli kirjoittaa koodi sillä tavalla, että toimintoja on helppo lisätä jatkossa.

Muutama havainto suunnittelupäätöksistä koskien syntaksia:
* trigonometristen funktioiden osalta päätin, että funktion voi syöttää ilman myös ilman sulkeita eli esim. 'sin 1' ja 'sin(1)' tulkitaan samalla tavalla.
* edellisestä johtuen esim. syöte 'sin cos tan 1' tulkitaan funktioksi 'sin(cos(tan(1)))'
* toistaiseksi esimerkiksi merkkijono '34abc' tulkitaan muuttujaksi, jatkossa syntaksia tarkistaessa hyväksyttyjä muuttujia voisi olla esim. merkkijonot jotka alkavat kirjaimilla ja voivat sisältää lopussa numeroita. Esim 'x3', 'pituus', 'leet1337' jne.

Tällä viikolla testaamiseen tuli keskityttyä hieman toisarvoisesti. Testikattavuus on sinänsä ihan ok, mutta testisyötteet testaavat toistaiseksi hyvin yksinkertaisia tapauksia. Huolimattomuusvirheitäkin saattaa olla. Yksi ensi viikon ensimmäisiä hommia olisi kirjoittaa Scanner dependency injection mallilla, niin yksikkötestaaminen muuttuisi monessa kohtaa mielekkäämmäksi. Testaukseen liittyviä ajatuksia kirjaan tarkemmin testausdokumenttiin. Jacoco on tosiaan käytössä (testikattavuus taisi olla 80% hujakoilla, main-metodi luonnollisestikin testaamatta ja juuri sieltä on tarkoitus saada se Scanner-olio pois...) Checkstyle on nykyisellä konfiguraatiolla puhdas, sieltä tuli poistettua switch:ltä pakollinen default, koska nykyinen Javan syntaksi ei sitä erityisesti vaadi.

Itse ohjelman osalta ensi viikolla painopiste taitaa olla syötteiden validoinnissa ja vuorossa voisi olla myös arvojen tallentaminen muuttujiin. Calculator-luokka alkaa myös olla jo melko pitkä, joten nyt voisi olla aika siirtää osa toiminnoista omiin luokkiinsa. Esim. valmiin postfix-muotoisen laskutoimituksen tuloksen laskemisen voisi siirtää omaan luokkaan. Melko selkeä kuva tälläkin hetkellä on mitä olen tekemässä, vaikka lauantai-iltana viikkoraportin kirjoittaminen on hieman puolihuolimatonta. Sivukommenttina todettakoon, että yllättävän hauskaa ohjelman kirjoittaminen on ollut.